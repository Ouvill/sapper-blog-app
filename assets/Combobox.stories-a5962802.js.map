{"version":3,"file":"Combobox.stories-a5962802.js","sources":["../../src/components/Combobox/DropDownItem.svelte","../../src/components/Icons/Loading.svelte","../../src/components/Combobox/DropDownMenu.svelte","../../src/components/Combobox/Input.svelte","../../src/components/Combobox/Combobox.svelte"],"sourcesContent":["<script lang=\"ts\">\n  export let imageUrl: string;\n  export let text: string;\n  export let selected: boolean;\n  export let id: string;\n</script>\n\n<li\n  role=\"option\"\n  aria-selected={selected}\n  {id}\n  class={`-mx-2 flex transform cursor-pointer items-center border-b px-4 py-3 transition-colors duration-200 last:border-0 hover:bg-gray-100 dark:border-zinc-700 dark:hover:bg-zinc-500 ${\n    selected ? \"bg-gray-100 dark:bg-zinc-500\" : \"\"\n  }`}\n  on:mousedown\n>\n  <img class=\"mx-1 h-8 w-8 rounded-full object-cover\" src={imageUrl} alt=\"\" />\n  <p class=\"mx-2 text-sm text-gray-600 dark:text-gray-50\">\n    {text}\n  </p>\n</li>\n","<svg\n  class=\"inline\"\n  version=\"1.1\"\n  id=\"loader-1\"\n  xmlns=\"http://www.w3.org/2000/svg\"\n  xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n  x=\"0px\"\n  y=\"0px\"\n  width=\"40px\"\n  height=\"40px\"\n  viewBox=\"0 0 50 50\"\n  style=\"enable-background:new 0 0 50 50;\"\n  xml:space=\"preserve\"\n>\n  <path\n    fill=\"currentColor\"\n    d=\"M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z\"\n  >\n    <animateTransform\n      attributeType=\"xml\"\n      attributeName=\"transform\"\n      type=\"rotate\"\n      from=\"0 25 25\"\n      to=\"360 25 25\"\n      dur=\"0.6s\"\n      repeatCount=\"indefinite\"\n    />\n  </path>\n</svg>\n","<script lang=\"ts\">\n  import DropDownItem from \"./DropDownItem.svelte\";\n  import Loading from \"../Icons/Loading.svelte\";\n  import type { Item } from \"./types\";\n  import { createEventDispatcher } from \"svelte\";\n  const dispatch = createEventDispatcher<{\n    select: Item;\n  }>();\n\n  export let items: Item[];\n  export let loading = false;\n  export let listboxId: string;\n  export let optionId: string;\n  export let activeIndex: number | null = null;\n</script>\n\n<div\n  on:keydown\n  class=\"overflow-hiddenrounded-br-md absolute z-20 max-h-96 w-72 overflow-y-scroll rounded-bl-md border-2 border-t-0 border-gray-200 bg-white shadow-lg dark:border-zinc-700 dark:bg-zinc-700\"\n>\n  {#if loading}\n    <div class=\"py-2 text-center\" aria-live=\"polite\" aria-atomic=\"true\">\n      <div class=\"sr-only\">検索中</div>\n      <Loading />\n    </div>\n  {:else if items.length === 0}\n    <div class=\"py-2 text-center\" aria-live=\"polite\" aria-atomic=\"true\">\n      <p class=\"text-gray-500 dark:text-gray-300\">検索結果がありません</p>\n    </div>\n  {:else}\n    <ul class=\"py-2\" role=\"listbox\" aria-label=\"検索結果\" id={listboxId}>\n      {#each items as item, index (item.key)}\n        <DropDownItem\n          imageUrl={item.imageUrl}\n          text={item.text}\n          selected={index === activeIndex}\n          id={`${optionId}-${index}`}\n          on:mousedown={() => {\n            dispatch(\"select\", item);\n          }}\n        />\n      {/each}\n    </ul>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import SearchIcon from \"../Icons/Search.svelte\";\n  export let value = \"\";\n  export let placeholder = \"\";\n  export let name = \"\";\n  export let required = false;\n  export let isOpen = false;\n  export let inputId = \"\";\n  export let listboxId = \"\";\n  export let optionId = \"\";\n  export let activeIndex: number | null;\n\n  export const focus = () => {\n    input.focus();\n  };\n\n  let input: HTMLInputElement;\n</script>\n\n<div\n  class=\"flex w-full rounded-lg border-2 border-gray-300 dark:border-zinc-700\"\n>\n  <input\n    bind:value\n    bind:this={input}\n    on:focus\n    on:blur\n    on:keydown\n    on:input\n    class=\"h-10 w-60 rounded-l-lg px-5 focus:outline-none dark:bg-zinc-900\"\n    type=\"text\"\n    id={inputId}\n    {name}\n    {required}\n    {placeholder}\n    role=\"combobox\"\n    aria-autocomplete=\"both\"\n    aria-expanded={isOpen}\n    aria-controls={listboxId}\n    aria-activedescendant={activeIndex !== null\n      ? `${optionId}-${activeIndex}`\n      : undefined}\n  />\n  <button class=\"flex justify-end rounded-r-lg p-2\" aria-label=\"検索\">\n    <SearchIcon className=\"text-gray-600 dark:text-gray-50 h-6 w-6\" />\n  </button>\n</div>\n","<script lang=\"ts\">\n  import DropDownMenu from \"./DropDownMenu.svelte\";\n  import Input from \"./Input.svelte\";\n  import type { Item } from \"./types\";\n  import { createEventDispatcher } from \"svelte\";\n  const dispatch = createEventDispatcher<{\n    select: Item;\n  }>();\n\n  export let value = \"\";\n  export let required = false;\n  export let loading = false;\n  export let items: Item[] = [];\n\n  let inputElement: { focus: () => void };\n  let activeIndex: number | null = null;\n  let isOpen = false;\n\n  const inputId = \"combobox\";\n  const listboxId = \"listbox\";\n  const optionId = \"option\";\n\n  $: itemCount = items.length;\n  $: {\n    if (!isOpen) {\n      activeIndex = null;\n    }\n  }\n\n  const handleInput = () => {\n    if (!value.trim()) {\n      isOpen = false;\n    } else {\n      isOpen = true;\n    }\n  };\n\n  const handleFocus = () => {\n    if (value.trim()) {\n      isOpen = true;\n    }\n  };\n\n  const handleBlur = () => {\n    isOpen = false;\n  };\n\n  const handleSelect = (e: CustomEvent<Item>) => {\n    value = e.detail.text;\n    dispatch(\"select\", e.detail);\n  };\n  /**\n   * 選択された要素が見えるようにスクロール\n   */\n  const scrollToOption = (index: number) => {\n    const listboxNode = document.getElementById(listboxId);\n    const opt = document.getElementById(`${optionId}-${index}`);\n    if (!listboxNode || !opt) return;\n\n    opt.scrollIntoView({ behavior: \"smooth\", block: \"nearest\" });\n  };\n\n  const navigateList = (e: KeyboardEvent) => {\n    if (e.key === \"ArrowDown\") {\n      e.preventDefault();\n      if (activeIndex === null) {\n        isOpen = true;\n        activeIndex = 0;\n      } else if (activeIndex < itemCount - 1) {\n        activeIndex++;\n      } else {\n        activeIndex = 0;\n      }\n      scrollToOption(activeIndex);\n    } else if (e.key === \"ArrowUp\") {\n      e.preventDefault();\n      if (activeIndex === null) {\n        isOpen = true;\n        activeIndex = 0;\n      } else if (activeIndex > 0) {\n        activeIndex--;\n      } else {\n        activeIndex = itemCount - 1;\n      }\n      scrollToOption(activeIndex);\n    } else if (e.key === \"Enter\") {\n      isOpen = false;\n      if (activeIndex !== null) {\n        e.preventDefault();\n        handleSelect({ detail: items[activeIndex] } as CustomEvent<Item>);\n        activeIndex = null;\n      }\n    } else if (e.key === \"Escape\") {\n      e.preventDefault();\n      inputElement.focus();\n\n      if (isOpen) {\n        isOpen = false;\n        activeIndex = null;\n      } else {\n        value = \"\";\n      }\n    }\n  };\n</script>\n\n<Input\n  bind:this={inputElement}\n  bind:value\n  on:focus={handleFocus}\n  on:blur={handleBlur}\n  on:keydown={navigateList}\n  on:input={handleInput}\n  {inputId}\n  {listboxId}\n  {optionId}\n  {activeIndex}\n  {required}\n  name=\"q\"\n  placeholder=\"Search\"\n/>\n{#if isOpen}\n  <DropDownMenu\n    {items}\n    {loading}\n    {listboxId}\n    {optionId}\n    {activeIndex}\n    on:select={handleSelect}\n  />\n{/if}\n"],"names":["ctx","attr","img","img_src_value","insert_hydration","target","li","anchor","append_hydration","p","imageUrl","$$props","text","selected","id","svg","path","animateTransform","get_key","i","ul","div","div1","div0","dirty","dropdownitem_changes","dispatch","createEventDispatcher","items","loading","listboxId","optionId","activeIndex","item","input_1","input_1_aria_activedescendant_value","button","current","value","placeholder","name","required","isOpen","inputId","focus","input","$$value","create_if_block","inputElement","handleInput","$$invalidate","handleFocus","handleBlur","handleSelect","e","scrollToOption","index","listboxNode","opt","navigateList","itemCount"],"mappings":"wdAkBKA,EAAI,CAAA,CAAA,wKAAJA,EAAI,CAAA,CAAA,2GAFkDA,EAAQ,CAAA,CAAA,GAAAC,EAAAC,EAAA,MAAAC,CAAA,qHAPlDH,EAAQ,CAAA,CAAA,iNAGrBA,EAAQ,CAAA,EAAG,+BAAiC,EAAC,EAAA,UALjDI,EAaIC,EAAAC,EAAAC,CAAA,EAJFC,EAA2EF,EAAAJ,CAAA,SAC3EM,EAEGF,EAAAG,CAAA,sEAHsDT,EAAQ,CAAA,CAAA,0BAE9DA,EAAI,CAAA,CAAA,2BATQA,EAAQ,CAAA,CAAA,oNAGrBA,EAAQ,CAAA,EAAG,+BAAiC,EAAC,4EAXpC,SAAAU,CAAgB,EAAAC,GAChB,KAAAC,CAAY,EAAAD,GACZ,SAAAE,CAAiB,EAAAF,GACjB,GAAAG,CAAU,EAAAH,ioECJvBP,EA4BKC,EAAAU,EAAAR,CAAA,EAdHC,EAaMO,EAAAC,CAAA,EATJR,EAQCQ,EAAAC,CAAA,gWCKQjB,EAAK,CAAA,EAAiB,MAAAkB,EAAAlB,GAAAA,KAAK,oBAAhC,OAAImB,GAAA,EAAA,oUAD8CnB,EAAS,CAAA,CAAA,UAA/DI,EAYIC,EAAAe,EAAAb,CAAA,yEAXKP,EAAK,CAAA,mEADwCA,EAAS,CAAA,CAAA,+BAC3D,OAAI,GAAA,gLAJsC,YAAU,2HAAV,YAAU,sLADxDI,EAEKC,EAAAgB,EAAAd,CAAA,EADHC,EAAyDa,EAAAZ,CAAA,uHALpC,KAAG,oJAAH,KAAG,uLAD1BL,EAGKC,EAAAiB,EAAAf,CAAA,EAFHC,EAA6Bc,EAAAC,CAAA,6MAWf,SAAAvB,KAAK,SACT,KAAAA,KAAK,KACD,SAAAA,QAAUA,EAAW,CAAA,EACxB,GAAA,GAAAA,QAAYA,EAAK,EAAA,CAAA,iMAHdwB,EAAA,IAAAC,EAAA,SAAAzB,KAAK,UACTwB,EAAA,IAAAC,EAAA,KAAAzB,KAAK,MACDwB,EAAA,KAAAC,EAAA,SAAAzB,QAAUA,EAAW,CAAA,GACxBwB,EAAA,IAAAC,EAAA,GAAA,GAAAzB,QAAYA,EAAK,EAAA,CAAA,oLAhB3BA,EAAO,CAAA,EAAA,EAKFA,EAAK,CAAA,EAAC,SAAW,EAAC,wVAT9BI,EA4BKC,EAAAgB,EAAAd,CAAA,6RAvCG,MAAAmB,EAAWC,SAIN,MAAAC,CAAa,EAAAjB,EACb,CAAA,QAAAkB,EAAU,EAAK,EAAAlB,GACf,UAAAmB,CAAiB,EAAAnB,GACjB,SAAAoB,CAAgB,EAAApB,EAChB,CAAA,YAAAqB,EAA6B,IAAI,EAAArB,6CAyBlCe,EAAS,SAAUO,CAAI,u+DCP3BjC,EAAO,CAAA,CAAA,sIAMIA,EAAM,CAAA,CAAA,sBACNA,EAAS,CAAA,CAAA,EACDC,EAAAiC,EAAA,wBAAAC,EAAAnC,OAAgB,KAChC,GAAAA,QAAYA,EAAW,CAAA,CAAA,GAC1B,MAAS,sKAtBjBI,EA2BKC,EAAAgB,EAAAd,CAAA,EAxBHC,EAoBCa,EAAAa,CAAA,6BACD1B,EAEQa,EAAAe,CAAA,gKAdFpC,EAAO,CAAA,CAAA,8HAMIA,EAAM,CAAA,CAAA,kCACNA,EAAS,CAAA,CAAA,GACD,CAAAqC,GAAAb,EAAA,KAAAW,KAAAA,EAAAnC,OAAgB,KAChC,GAAAA,QAAYA,EAAW,CAAA,CAAA,GAC1B,yMAvCK,GAAA,CAAA,MAAAsC,EAAQ,EAAE,EAAA3B,EACV,CAAA,YAAA4B,EAAc,EAAE,EAAA5B,EAChB,CAAA,KAAA6B,EAAO,EAAE,EAAA7B,EACT,CAAA,SAAA8B,EAAW,EAAK,EAAA9B,EAChB,CAAA,OAAA+B,EAAS,EAAK,EAAA/B,EACd,CAAA,QAAAgC,EAAU,EAAE,EAAAhC,EACZ,CAAA,UAAAmB,EAAY,EAAE,EAAAnB,EACd,CAAA,SAAAoB,EAAW,EAAE,EAAApB,GACb,YAAAqB,CAA0B,EAAArB,QAExBiC,EAAK,IAAA,CAChBC,EAAM,MAAK,OAGTA,wMAQSA,EAAKC,q2FCwGL9C,EAAY,EAAA,CAAA,0fAnBfA,EAAW,CAAA,CAAA,eACZA,EAAU,CAAA,CAAA,kBACPA,EAAY,EAAA,CAAA,gBACdA,EAAW,CAAA,CAAA,QASlBA,EAAM,CAAA,GAAA+C,GAAA/C,CAAA,kRAANA,EAAM,CAAA,0OAvGH,MAAA2C,GAAU,WACVb,EAAY,UACZC,GAAW,kCAfX,MAAAL,EAAWC,KAIN,GAAA,CAAA,MAAAW,EAAQ,EAAE,EAAA3B,EACV,CAAA,SAAA8B,EAAW,EAAK,EAAA9B,EAChB,CAAA,QAAAkB,EAAU,EAAK,EAAAlB,GACf,MAAAiB,EAAK,EAAA,EAAAjB,EAEZqC,EACAhB,EAA6B,KAC7BU,EAAS,SAaPO,EAAW,IAAA,CACVX,EAAM,OAGTY,EAAA,EAAAR,EAAS,EAAI,EAFbQ,EAAA,EAAAR,EAAS,EAAK,GAMZS,EAAW,IAAA,CACXb,EAAM,QACRY,EAAA,EAAAR,EAAS,EAAI,GAIXU,EAAU,IAAA,CACdF,EAAA,EAAAR,EAAS,EAAK,GAGVW,EAAgBC,GAAoB,CACxCJ,EAAA,EAAAZ,EAAQgB,EAAE,OAAO,IAAI,EACrB5B,EAAS,SAAU4B,EAAE,MAAM,GAKvBC,EAAkBC,GAAa,CAC7B,MAAAC,GAAc,SAAS,eAAe3B,CAAS,EAC/C4B,GAAM,SAAS,eAAkB,GAAA3B,EAAQ,IAAIyB,CAAK,EAAA,EACnD,CAAAC,KAAgBC,IAErBA,GAAI,eAAiB,CAAA,SAAU,SAAU,MAAO,SAAS,CAAA,GAGrDC,EAAgBL,GAAgB,CAChCA,EAAE,MAAQ,aACZA,EAAE,eAAc,EACZtB,IAAgB,MAClBkB,EAAA,EAAAR,EAAS,EAAI,EACbQ,EAAA,EAAAlB,EAAc,CAAC,GACNA,EAAc4B,EAAY,MACnC5B,IAAWA,CAAA,EAEXkB,EAAA,EAAAlB,EAAc,CAAC,EAEjBuB,EAAevB,CAAW,GACjBsB,EAAE,MAAQ,WACnBA,EAAE,eAAc,EACZtB,IAAgB,MAClBkB,EAAA,EAAAR,EAAS,EAAI,EACbQ,EAAA,EAAAlB,EAAc,CAAC,GACNA,EAAc,MACvBA,IAAWA,CAAA,MAEXA,EAAc4B,EAAY,CAAC,EAE7BL,EAAevB,CAAW,GACjBsB,EAAE,MAAQ,SACnBJ,EAAA,EAAAR,EAAS,EAAK,EACVV,IAAgB,OAClBsB,EAAE,eAAc,EAChBD,EAAe,CAAA,OAAQzB,EAAMI,CAAW,CAAA,CAAA,EACxCkB,EAAA,EAAAlB,EAAc,IAAI,IAEXsB,EAAE,MAAQ,WACnBA,EAAE,eAAc,EAChBN,EAAa,MAAK,EAEdN,GACFQ,EAAA,EAAAR,EAAS,EAAK,EACdQ,EAAA,EAAAlB,EAAc,IAAI,GAElBkB,EAAA,EAAAZ,EAAQ,EAAE,6CAOLU,EAAYF,kNArFpBc,EAAYhC,EAAM,wBAEdc,GACHQ,EAAA,EAAAlB,EAAc,IAAI;;;;;;;;;;;;;;;;;;"}